{"version":3,"file":"VThree.js","sourceRoot":"","sources":["VThree.ts"],"names":[],"mappings":"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","sourcesContent":["/// <reference path=\"typings/index.d.ts\" />\n\nclass VThree\n{\n\n    // 現在のシーンの番号\n    public NUM:number = 0;\n    // シーンを格納する配列\n    public scenes:any[] = [];\n    // Renderer\n    public renderer:THREE.WebGLRenderer;\n    private controls:Object;\n\n    private opacityStep:number = 0.1;\n    private opacity:number = 1.0;\n\n    public transparent:boolean = false;\n    public key_sceneNext:string = \"ArrowRight\";\n    public key_scenePrev:string = \"ArrowLeft\";\n\n    private isOrbitControls:boolean = false;\n    constructor(startAlpha:number,transparent:boolean)\n    {\n\n\n        this.opacity = startAlpha;\n        this.transparent = transparent;\n\n\n        // 初期化処理後、イベント登録\n        this.init();\n\n        window.addEventListener( 'resize', this.onWindowResize, false );\n        window.addEventListener( 'click', this.onClick, false );\n        document.addEventListener(\"keydown\", this.onKeyDown, true);\n        document.addEventListener(\"keyup\", this.onKeyUp, true);\n\n\n    }\n\n    public enableOrbitControls()\n    {\n\n    }\n\n    public initOrbitContorols()\n    {\n\n    }\n\n\n    // test\n\n    public init()\n    {\n\n        // Rendererを作る\n        this.renderer = new THREE.WebGLRenderer({antialias: true, alpha:true});\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.renderer.sortObjects = false;\n        this.renderer.shadowMap.enabled = true;\n        this.renderer.shadowMap.type = THREE.BasicShadowMap;\n        this.renderer.domElement.id = \"main\";\n        document.body.appendChild( this.renderer.domElement );\n\n        this.updateCanvasAlpha();\n    }\n\n    // 管理したいシーンを格納する関数\n\n    public addScene(scene:Object)\n    {\n\n        this.scenes.push(scene);\n\n    }\n\n\n    // ウィンドウの幅が変わったときの処理\n    public onWindowResize = () =>\n    {\n        var windowHalfX = window.innerWidth / 2;\n        var windowHalfY = window.innerHeight / 2;\n        this.scenes[this.NUM].camera.aspect = window.innerWidth / window.innerHeight;\n        this.scenes[this.NUM].camera.updateProjectionMatrix();\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n\n        console.log(\"resize\");\n    }\n\n    // 現在のシーン番号が、不適切な値にならないようにチェック\n    public checkNum = () =>\n    {\n        if(this.NUM <0)\n        {\n            this.NUM = this.scenes.length-1;\n        }\n\n        if(this.NUM >= this.scenes.length)\n        {\n            this.NUM = 0;\n        }\n\n        if(this.NUM == 1 )\n        {\n            $(\".sceneinfo\").html(\n                \"change animation [SPACE_KEY]<br>\"\n                +\"speed down [S]<br>\"\n                +\"change FOV[D]\"\n            );\n        }\n        if(this.NUM == 2 )\n        {\n            $(\".sceneinfo\").text(\"speed down [SPACE_KEY]\");\n        }\n        if(this.NUM == 3 )\n        {\n            $(\".sceneinfo\").text(\"change mesh [SPACE_KEY]\");\n        }\n\n        if(this.NUM == 4 )\n        {\n            $(\".sceneinfo\").text(\" \");\n            $(\".sceneinfo\").html(\n                \"speed down [SPACE_KEY]<br>\"\n                +\"enable mouse control [C]\"\n            );\n        }\n\n        if(this.NUM == 5 )\n        {\n            $(\".sceneinfo\").text(\" \");\n        }\n\n        if(this.NUM == 6 )\n        {\n            $(\".sceneinfo\").html(\n                \"reset noise value [R]<br>\"\n                +\"change texture [T]<br>\"\n                +\"speed Up or Down [A]<br>\"\n                +\"change vector [V]<br>\"\n                +\"change FOV [D]<br>\"\n                +\"rotate img [C]<br>\"\n\n            );\n        }\n        if(this.NUM == 0 )\n        {\n            $(\".sceneinfo\").text(\" \");\n\n        }\n\n    }\n\n    public  onClick = () => {\n        this.scenes[this.NUM].click();\n    }\n    // ←→キーでシーン番号を足し引き\n\n    public onKeyUp = (e:KeyboardEvent) => {\n        this.scenes[this.NUM].keyUp(e);\n    }\n\n    public onKeyDown = (e:KeyboardEvent) => {\n\n\n        if(isFinite(Number(e.key)) && e.key != \" \")\n        {\n            console.log(\"number: \" + e.key);\n            // console.log(\"number: \" + Number);\n            this.NUM = Number(e.key);\n            this.checkNum();\n        }\n\n        console.log(e);\n        // console.log(this.NUM);\n        if(e.key == this.key_sceneNext)\n        {\n            this.NUM++;\n            this.checkNum();\n        }\n        if( e.key == this.key_scenePrev)\n        {\n\n            this.NUM--;\n            this.checkNum();\n        }\n\n\n        if(e.key == \"ArrowUp\")\n        {\n            this.opacity += this.opacityStep;\n\n            if(this.opacity > 1.0)\n            {\n\n                this.opacity = 1.0;\n            }\n\n            this.updateCanvasAlpha();\n\n        }\n        if( e.key == \"ArrowDown\")\n        {\n\n            this.opacity -= this.opacityStep;\n\n            if(this.opacity < 0.0)\n            {\n\n                this.opacity = 0.0;\n            }\n            this.updateCanvasAlpha();\n        }\n\n\n        console.log(this.NUM);\n\n        this.scenes[this.NUM].keyDown(e);\n\n\n\n\n\n\n\n\n\n\n    }\n\n    private updateCanvasAlpha()\n    {\n        if(this.transparent)\n        {\n            this.renderer.domElement.style.opacity = this.opacity;\n        }\n\n\n    }\n\n\n    // 最終的な描写処理と、アニメーション関数をワンフレームごとに実行\n    public draw() {\n\n        this.scenes[this.NUM].update();\n        this.renderer.render(this.scenes[this.NUM].scene, this.scenes[this.NUM].camera);\n        requestAnimationFrame(this.draw.bind(this));\n\n    }\n}\n\n"]}