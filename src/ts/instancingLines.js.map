{"version":3,"file":"instancingLines.js","sourceRoot":"","sources":["instancingLines.ts"],"names":[],"mappings":"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","sourcesContent":["/// <reference path=\"typings/index.d.ts\" />\n\nclass InstancingLines{\n\n    public scene: THREE.Scene;\n    public camera: THREE.Camera;\n    private renderer:THREE.WebGLRenderer;\n    private noise:Object;\n\n\n    private WIDTH:number;\n    private PARTICLES:number;\n\n\n\n\n    constructor(renderer:THREE.WebGLRenderer) {\n\n        // renderer.setClearColor(0xffffff);\n        this.renderer = renderer;\n        this.createScene();\n\n        let width = 100;\n        this.WIDTH = width;\n        this.PARTICLES =  width * width;\n\n    }\n\n\n\n\n    // シーンを作る。ここでオブジェクトを格納していく。\n    private createScene(){\n\n        this.noise = new SimplexNoise();\n\n\n        // シーンを作る\n        this.scene = new THREE.Scene();\n\n        // カメラを作成\n        this.camera = new THREE.PerspectiveCamera( 50, window.innerWidth/window.innerHeight, 0.1, 10000 );\n        // this.camera.position.z = 1400;\n        // this.camera.position.y = 20;\n\n        var triangles = 1;\n        var instances = 65000;\n        var geometry = new THREE.InstancedBufferGeometry();\n        geometry.maxInstancedCount = instances; // set so its initalized for dat.GUI, will be set in first draw otherwise\n        var vertices = new THREE.BufferAttribute( new Float32Array( triangles * 3 * 3 ), 3 );\n        vertices.setXYZ( 0, 0.025, -0.025, 0 );\n        vertices.setXYZ( 1, -0.025, 0.025, 0 );\n        vertices.setXYZ( 2, 0, 0, 0.025 );\n        geometry.addAttribute( 'position', vertices );\n        var offsets = new THREE.InstancedBufferAttribute( new Float32Array( instances * 3 ), 3, 1 );\n        for ( var i = 0, ul = offsets.count; i < ul; i++ ) {\n            offsets.setXYZ( i, Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5 );\n        }\n        geometry.addAttribute( 'offset', offsets );\n        var colors = new THREE.InstancedBufferAttribute( new Float32Array( instances * 4 ), 4, 1 );\n        for ( var i = 0, ul = colors.count; i < ul; i++ ) {\n            colors.setXYZW( i, Math.random(), Math.random(), Math.random(), Math.random() );\n        }\n        geometry.addAttribute( 'color', colors );\n        var vector = new THREE.Vector4();\n        var orientationsStart = new THREE.InstancedBufferAttribute( new Float32Array( instances * 4 ), 4, 1 );\n        for ( var i = 0, ul = orientationsStart.count; i < ul; i++ ) {\n            vector.set( Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1 );\n            vector.normalize();\n            orientationsStart.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n        }\n        geometry.addAttribute( 'orientationStart', orientationsStart );\n        var orientationsEnd = new THREE.InstancedBufferAttribute( new Float32Array( instances * 4 ), 4, 1 );\n        for ( var i = 0, ul = orientationsEnd.count; i < ul; i++ ) {\n            vector.set( Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1 );\n            vector.normalize();\n            orientationsEnd.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n        }\n        geometry.addAttribute( 'orientationEnd', orientationsEnd );\n        // material\n        var material = new THREE.RawShaderMaterial( {\n            uniforms: {\n                time: { value: 1.0 },\n                sineTime: { value: 1.0 }\n            },\n            vertexShader: document.getElementById( 'vertexShader_line' ).textContent,\n            fragmentShader: document.getElementById( 'fragmentShader_line' ).textContent,\n            side: THREE.DoubleSide,\n            transparent: true\n        } );\n        var mesh = new THREE.Mesh( geometry, material );\n        this.scene.add( mesh );\n        this.renderer.setClearColor( 0x101010 );\n\n        let controls = new THREE.OrbitControls( this.camera, this.renderer.domElement );\n\n\n\n    }\n\n\n    public click()\n    {\n\n    }\n\n    public keyDown()\n    {\n\n    }\n    // ワンフレームごとの処理\n    public update() {\n\n\n        // var time = performance.now();\n        // var object = this.scene.children[0];\n        // object.rotation.y = time * 0.0005;\n        // object.material.uniforms.time.value = time * 0.005;\n        // object.material.uniforms.sineTime.value = Math.sin( object.material.uniforms.time.value * 0.05 );\n\n\n\n\n\n\n\n    }\n\n\n}\n\n\n"]}